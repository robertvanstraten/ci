import numpy as np
import pandas as pd
import spacy as spacy

from numpy import nan
from pandas import DataFrame, Series


def test_1(mse_random):
    print("Testing mse value: ", end='')
    assert mse_random > 3.0, "expected mse value > 3.0"
    assert mse_random < 4.0, "expected mse value < 4.0"
    print("success!")


def test_2(mse_mean, mse_cf_item_based):
    print("Testing mse value: ", end='')
    assert mse_mean < mse_cf_item_based, f"expected mse < {mse_cf_item_based:.4f}"
    print('success!')


def test_4(mse_genres):
    print("Testing mse value: ", end='')
    assert mse_genres > 0.8 and (
        mse_genres < 0.9), "expected mse value around 0.84"
    print("success!")


def test_7(bag_of_words):
    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    nlp = spacy.load('en_core_web_sm')

    print(
        "Testing bag of words with a text that does NOT contain punctuation: ",
        end="")
    solution = Series([1, 1, 1], index=['duck', 'cross', 'road']).astype(
        "int64")
    doc = nlp("the duck crossed the road again and again")
    student_answer = bag_of_words(doc)
    _test_series(student_answer, solution)
    print("Succes!")

    print("Testing bag of words with a text that does contain punctuation: ",
          end="")
    solution = Series([1, 1, 1], index=['duck', 'cross', 'road']).astype(
        "int64")
    doc = nlp("the duck crossed, the road again and again.")
    student_answer = bag_of_words(doc)
    _test_series(student_answer, solution)
    print("Succes!")


def test_8(doc, bag_of_words, term_frequency, nlp):
    print(
        "Testing term_frequency on the text 'english english english word word random': ",
        end="")
    solution = Series([0.5, 0.3333333333333333, 0.16666666666666666],
                      index=['english', 'word', 'random']).astype("float64")

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    doc = nlp("english english english word word random")
    bag = bag_of_words(doc)
    student_answer = term_frequency(bag)
    _test_series((student_answer * 100).map(int), (solution * 100).map(int))
    print("Succes!")


def test_9(nlp, bag_of_words, inverse_document_frequency):
    print("Testing inverse document frequency: ", end="")

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    solution = Series(
        [1.0986122886681098, 0.0, 0.4054651081081644, 1.0986122886681098],
        index=['english', 'random', 'roof', 'word']).astype("float64")

    bag1 = bag_of_words(nlp("english english english word word random"))
    bag2 = bag_of_words(nlp("roof roof random"))
    bag3 = bag_of_words(nlp("roof random"))
    student_answer = inverse_document_frequency([bag1, bag2, bag3])
    _test_series(student_answer, solution)
    print("Succes!")


def test_11(nlp, bag_of_words, tf_idf):
    idf = pd.read_pickle('./data/idf.pkl')

    def _test_series(student_answer, solution):
        assert type(
            student_answer) == Series, "Expected your answer to be of type Series"
        assert set(student_answer.index) == set(
            solution.index), f"solution index: {solution.index}, your index: {student_answer.index}"
        for word in solution.index:
            assert solution[word] == student_answer[
                word], f"Expected {solution[word]} at '{word}' but found {student_answer[word]}"

    print("Testing tf_idf: ", end="")
    solution = Series(
        [0.9700282369019263, 0.0649750369302339, 0.4454819004385067],
        index=['english', 'word', 'random']).astype("float64")

    bag = bag_of_words(nlp("english english english word word random"))
    student_answer = tf_idf(bag, idf)
    _test_series(student_answer, solution)
    print("Succes!")


def test_16(frame):
    print("Testing: ", end="")

    frame = frame.astype("float64")
    solution = DataFrame([[1.0, 0.33510586690428007, 0.44173321095505513,
                           0.7517859342501927, 0.5248965400138786],
                          [0.33510586690428007, 1.0, 0.7453350795732844,
                           0.3677176990934737, 0.6501385254601899],
                          [0.44173321095505513, 0.7453350795732844, 1.0,
                           0.48254533689518175, 0.7573737418959072],
                          [0.7517859342501927, 0.3677176990934737,
                           0.48254533689518175, 1.0, 0.580948308759836],
                          [0.5248965400138786, 0.6501385254601899,
                           0.7573737418959072, 0.580948308759836, 1.0]],
                         columns=['recommender', 'warren', 'biden',
                                  'machinelearning', 'brexit'],
                         index=['recommender', 'warren', 'biden',
                                'machinelearning', 'brexit'])
    print(type(frame))
    pd.testing.assert_frame_equal(frame, solution)
    print("Success")


def test_18(compute_vector, nlp_headlines, similarity):
    print("Testing compute_vector: ", end="")

    utility = pd.DataFrame([compute_vector(doc) for _, doc in
                            nlp_headlines.items()], index=nlp_headlines.index)

    solution = DataFrame([[-0.3044250048696995, -0.13128799945116043, 0.20573725295253098, -0.03418750315904617, 0.19169150479137897, 0.06969422596739605, 0.052097756415605545, -0.005138581327628344, 0.061538003385066986, 0.8685954883694649, 0.12028400041162968, -0.11631325073540211, 0.21118925185874104, -0.12546025216579437, -0.20542750880122185, 0.15062500350177288, -0.09706075396388769, 1.7250750064849854, -0.10411624796688557, -0.1908322563394904, 0.17162000015377998, -0.12550425063818693, 0.20658274833112955, 0.01632850244641304, 0.14203750155866146, 0.03916774760000408, 0.10919249057769775, -0.09675424918532372, 0.2736718951491639, -0.11379519826732576, -0.19280500710010529, -0.1338760033249855, 0.4461185112595558, -0.009482750669121742, -0.061736248433589935, -0.18259575497359037, 0.0942000076174736, 0.10072098148521036, -0.1636475007981062, -0.040577493607997894, -0.047772498801350594, -0.05799524858593941, -0.2611255059018731, 0.36916099581867456, -0.11259924992918968, 0.19816824933514, 0.10592499747872353, 0.06820274656638503, 0.2525377543643117, 0.21177749708294868, 0.16518699191510677, -0.067564248573035, -0.13644699845463037, 0.4431825019419193, -0.3814924992620945, -0.20280700083822012, -0.011540006846189499, 0.0007735067047178745, -0.31243724934756756, 0.043689253740012646, 0.04952750727534294, 0.23719950625672936, 0.1712775006890297, -0.013244997709989548, 0.39840924367308617, 0.2645360017195344, -0.08185450499877334, 0.17841225024312735, 0.033446745947003365, -0.23313900642096996, -0.1587017502170056, -0.3279450014233589, 0.15694775618612766, -0.06903222494293004, 0.13061024737544358, -0.09386674873530865, -0.06884450046345592, -0.0035592522472143173, -0.029714497737586498, 0.4729725047945976, -0.15952250733971596, 0.18252919253427535, 0.35590000450611115, -0.2821057513356209, -0.1596557511948049, -0.3071764940395951, -0.5803599916398525, 0.21100550657138228, 0.15035050176084042, 0.3868384938687086, -0.19492599996738136, -0.16491976869292557, -0.3149845004081726, -0.1611957517452538, 0.3902097614482045, -0.004064992070198059, 0.3836299926042557, -0.04724324960261583, 0.04289749637246132, -0.3921687453985214, -0.20913150534033775, -0.48205750808119774, -0.18495749682188034, -0.08138752193190157, 0.08787399344146252, -1.8343749642372131, -0.006535998545587063, 0.23880424816161394, -0.06844249926507473, -0.03673875145614147, 0.11451124865561724, -0.15479700127616525, 0.026050502434372902, -0.2048574946820736, -0.13540399726480246, -0.006036247126758099, 0.0625694990158081, 0.1616982463747263, -0.18501500459387898, 0.14374500140547752, 0.09841011727166915, 0.009097496047616005, -0.08531657187268138, -0.06412400119006634, -0.0698079951107502, 0.10117924655787647, 0.173510504886508, 0.2221602569334209, 0.2963060028851032, -0.15749749913811684, 0.08715000189840794, -0.17984474543482065, 0.09784000366926193, -0.1712274979799986, 0.03106750175356865, 0.2248775027692318, 0.04441099800169468, 0.13862749189138412, 0.14454749785363674, 0.06805724371224642, -0.016609500162303448, -0.3879242464900017, 0.0090900007635355, -0.16870250552892685, -0.04270049510523677, -0.2601874954998493, -0.1716235028579831, -0.0945737489964813, -0.013697249814867973, 0.10183800011873245, 0.2574324980378151, -0.3159775175154209, 0.005100000649690628, 0.3180399350821972, -0.06119250087067485, 0.1558899972587824, 0.12174199847504497, -0.1351607572287321, 0.2584712542593479, 0.20431424770504236, -0.14587074890732765, 0.04034099541604519, -0.06586000323295593, -0.2721699960529804, -0.28870409954106435, -0.19287417642772198, -0.1294974945485592, -0.1042374949902296, 0.11555675137788057, 0.01870500110089779, 0.003665620111860335, 0.2862999960780144, 0.14225775375962257, -0.14501000195741653, 0.20953524857759476, -0.02183782376232557, 0.23277775151655078, 0.42886850982904434, 0.3005400002002716, 0.2890504989773035, 0.027930499985814095, -0.034084998071193695, 0.14964174572378397, -0.23315250128507614, -0.07437999593093991, 0.0007099956274032593, -0.21365999663248658, 0.007613250985741615, -0.11283750087022781, -0.1784847464878112, -0.07960797566920519, -0.1933592539280653, -0.08747999835759401, 0.09389874711632729, -0.15272000432014465, -0.0721647460013628, -0.2156922509893775, -0.010298250010237098, -0.07880499958992004, 0.19054825557395816, -0.13264625240117311, -0.26205907529219985, 0.023602493107318878, 0.16597097530029714, -0.2677042484283447, -0.10272850282490253, 0.04369250312447548, -0.05764550156891346, 0.03817975055426359, 0.12527599930763245, -0.13849999755620956, -0.2979992516338825, 0.03753824811428785, -0.28684499859809875, 0.013314744457602501, -0.09094074182212353, -0.028924245852977037, 0.28955225087702274, -0.44160499423742294, -0.18628399912267923, 0.318292498588562, 0.04687174502760172, 0.13553350744768977, 0.1458730057347566, -0.001987747848033905, 0.14929800294339657, 0.1418627481907606, -0.1632615029811859, 0.06020824611186981, 0.3291334919631481, -0.37528249993920326, -0.08377249538898468, -0.23983849957585335, -0.22843925654888153, 0.178784498013556, 0.18363874964416027, 0.08615299873054028, 0.17383000254631042, -0.04613375011831522, 0.18739774823188782, 0.16553299687802792, -0.18146989773958921, -0.028972502797842026, -0.21494525857269764, -0.009544247761368752, -0.07465750724077225, -0.15005252812989056, 0.013314999639987946, -0.24540424719452858, 0.05474499240517616, 0.030925752595067024, 0.0488822516053915, -0.12413299642503262, 0.18129800027236342, 0.05342700332403183, -0.3777125026099384, -0.026337496004998684, -0.14537474885582924, -0.059246256947517395, -0.15795499831438065, 0.19787374883890152, -0.19281225558370352, 0.06675970007199794, 0.2414547516964376, -0.14897817908786237, -0.32113999873399734, -0.024352004751563072, 0.29502175003290176, 1.0345550030469894, 0.1104277262929827, -0.22851500241085887, -0.23900500312447548, -0.0006557540036737919, -0.12970750033855438, -0.14380099903792143, 0.011111695202998817, -0.016892650281079113, -0.011087749619036913, 0.03808400221168995, -0.29026251286268234, 0.06950251013040543, -0.07728239940479398, 0.34846500121057034, -0.42843250930309296, -0.36062750592827797, -0.3646399974822998, -0.2125822538509965, 0.04511974845081568, 0.11064875032752752, -0.16699399892240763, -0.44248974323272705, -0.21045725047588348, 0.057781245559453964, 0.5162599980831146, 0.08829107717610896, -0.10051999986171722, 0.12717249989509583, 0.21574125438928604, 0.10720999538898468, 0.022134996950626373],                      [-0.035840999867234914, 0.10164785704442433, 0.11272485740482807, 0.019364998808928897, -0.06850302778184414, -0.0307191719434091, 0.2657120111315245, -0.2356621442096574, 0.20080885823283876, 1.141720005444118, -0.04741143222366061, -0.21094195314383665, -0.02203414456120559, -0.06625642547649997, -0.32375286306653706, 0.11676385094012533, 0.017473858914205005, 0.016934138323579515, -0.16174128651618958, -0.09649257574762617, 0.010688012133219413, 0.28321414973054615, 0.3717922791838646, -0.2361337154039315, 0.025606426410377026, 0.03348228761128017, -0.4622957163623401, 0.17641971366746084, -0.1321615736399378, -0.12465071571724755, 0.13649571580546244, 0.14503713803631918, -0.09625014449868884, -0.02874614391475916, 0.04435671546629497, -0.04364914620029075, -0.28703857745443073, 0.14176337933167815, -0.2527914323977062, -0.17601656860538892, 0.21094488485583238, 0.1787718619619097, -0.03364243072324565, -0.17128685542515346, -0.04127900009708745, 0.02001754360805665, -0.06773451758947756, -0.1266235670607005, 0.014800422957965307, 0.012128199650240796, 0.022257710940071514, 0.06601700173424822, -0.10292328654655389, 0.011715714420591081, -0.0711509431047099, -0.06002742903573172, -0.23311163218958036, 0.015973854277815138, -0.10499614011496305, 0.009165116851883275, -0.3082452852811132, 0.09425471723079681, -0.1591138547020299, -0.1999499989407403, 0.08014260667758728, -0.12087513958769185, -0.18371914140880108, 0.20417613695774758, 0.175025717488357, -0.21813585768852914, -0.03369085091565337, -0.010239998144762856, 0.05660528689622879, 0.09066085577277201, 0.04646042627947671, -0.09350057478461947, 0.014213570526668004, 0.22296257583158358, 0.07547814186130251, -0.06420814378985337, 0.020604284746306285, 0.10375542087214333, -0.040455429681709835, 0.053759285914046426, -0.08626399721418108, -0.12676857198987687, 0.8441077066319329, -0.23864342591592244, 0.13046085834503174, -0.014316286891698837, -0.1439809953527791, 0.20923428051173687, 0.08598242966192109, -0.1542951443365642, 0.25467000369514736, -0.029561859954680716, 0.11744171274559838, 0.11466339975595474, -0.11037128285637923, -0.12496928391712052, 0.17063871584832668, -0.08204114277447973, 0.06463428746376719, -0.041838424546378, -0.1365771439990827, -0.8045842871069908, 0.025491711284433092, -0.26060742725219044, -0.13453328157109873, 0.13650343034948623, 0.13238057015197618, 0.13935483207127877, 0.03452657588890621, -0.09479428455233574, -0.041571431926318576, 0.026765856093594005, 0.2794084218995912, -0.09495999557631356, -0.10345257499388286, 0.09069638353373323, -0.11745271139911242, 0.16276057570108346, -0.012871629292411464, 0.15658900141716003, 0.023961284330912998, -0.09822629099653568, 0.04217814228364399, 0.023181425673621043, 0.08277414473039764, 0.2596298541341509, -0.1620928602559226, 0.01377428216593606, 0.22336843237280846, -0.3147225741829191, -0.1408657091004508, 0.0018242810453687394, -0.15554697292723826, 0.13108900082962854, 0.1609066047572664, -0.20796070992946625, -1.1111185806138175, -0.0719644304897104, -0.06133971043995449, -0.01059005645635937, -0.05138828259493623, -0.045280286243983676, 0.33134928265852587, -0.11851470651371139, -0.17982327725206101, -0.1512888546234795, 0.09569642905678068, -0.3951172871249063, -0.23116663903264062, 0.025605140519993647, 0.22720428662640707, -0.10406175340592329, 0.097947858273983, -0.11360285950026341, -0.08801285816090447, 0.025646287415708815, 0.23300343326159886, 0.14394113767359937, -0.24628599733114243, 0.25182628099407467, 0.18791142318929946, -0.06566371555839266, -0.022835858166217804, 0.023781431572777883, 0.009306924218045813, 0.06092171557247639, -0.01062699912914208, 0.06782471747802836, -0.061539288078035624, 0.0245134314256055, 0.05212243327072689, -0.19716191205329128, 0.05993657239845821, 0.2743172993234891, 0.15276057326367923, 0.35617528589708464, 0.17726000305265188, 0.12429843257580485, 0.03030614448445184, -0.03872499854436943, 0.1360328579986734, 0.15534399982009614, -0.10755898800146367, -0.029993997886776924, -0.2293850045119013, 0.06330077004219804, 0.021550288689988, 0.1276653987089438, -0.1633125745824405, -0.11683000198432378, 0.03997143251555307, 0.030136742496064732, -0.08578637322144848, 0.185467286833695, 0.32280928934259073, -0.2613494335008519, 0.08060571338449206, -0.17280500821237052, 0.189812856061118, -0.3248217137796538, -0.04166284842150552, 0.029056455341300795, 0.04469771363905498, -0.17831571400165558, -0.28520714385168894, -0.18450571543404035, 0.07580385463578361, 0.35999285323279245, 0.12557028446878707, 0.43697285412677694, 0.1785458597753729, -0.04312584974936077, -0.09124757243054253, 0.00128728843161038, -0.044401424803904126, 0.1571374274790287, -0.15776957065931388, 0.3748514311654227, -0.06101399872984205, 0.07794678583741188, 0.09597714404974665, 0.15590157040527888, -0.2770160048135689, -0.11527840334123798, -0.09404956788888999, -0.1163898566737771, 0.03361641502540026, 0.10692784289962479, -0.0328117402220544, -0.08260503045416304, -0.23179328335183008, -0.16255985626152583, -0.011416999490133353, -0.07944700095270361, -0.0029307116887399127, 0.20167534946397478, -0.07115528652710575, -0.17228786328009196, 0.2031459973326751, -0.23271743208169937, -0.07057671381958894, 0.008940995271716799, 0.20756642520427704, 0.17449599717344558, -0.10321828190769468, -0.2937398547572749, 0.2989982824240412, -0.04875942426068442, -0.12301695732665914, -0.11157042958906718, -0.09823400261146682, -0.26749700361064505, -0.22040902018280967, -0.1928297477799268, 0.08637056845639433, -0.0188444299357278, -0.00458800100854465, -0.007911715656518936, -0.12881271753992354, 0.1647571474313736, -0.09500099771789142, -0.2646611396755491, 0.18139399960637093, -0.0511772877403668, -0.1885071439402444, 0.21464942289250238, -0.11148957455796855, 0.08995914139917918, 0.09451257224593844, 0.10939857520030014, 0.006853700282850436, 0.08056328565414463, 0.4325822035648993, -0.05617528408765793, -0.12206142395734787, -0.12344943359494209, -0.2040551421897752, -0.05974592878815851, -0.14703385531902313, 0.2054409986095769, -0.0014998534960406168, -0.03891286253929138, 0.03593600168824196, 0.21932571062019893, -0.32855327760002445, 0.07240628451108932, 0.13583700012947833, -0.007158572120325906, 0.060583570173808506, 0.009363002276846341, 0.18639257071273668, -0.012941994837352208, 0.291850854243551, -0.1948693435073697, -0.18935043098671095, -0.09586271111454282],                      [0.00033089324278989807, 0.06994524877518415, 0.08457261766307056, 0.08468274353072047, -0.014021498849615455, -0.31378514715470374, 0.02921249927021563, -0.029770876746624708, 0.10583874676376581, 2.049713745713234, -0.052395124919712543, -0.050703083477856126, -0.11744287447072566, 0.26613324228674173, -0.11374263279139996, 0.10140549018979073, -0.08758586549083702, 0.4700672524049878, -0.21363039896823466, 0.3422225024551153, 0.020858753472566605, 0.04640050232410431, 0.37484811898320913, -0.053521370980888605, 0.1287513735005632, 0.023418747237883508, -0.2884284956380725, -0.1324974987655878, -0.1697637476027012, 0.20758100086823106, 0.21020600106567144, 0.051964749582111835, 0.05256799701601267, -0.12013499904423952, -0.04677162226289511, 0.03959404875058681, -0.057692626025527716, -0.1801050016656518, -0.15332088840659708, -0.057931584131438285, 0.10128975007683039, 0.14563125185668468, 0.030909880064427853, 0.014638497959822416, 0.019639750942587852, -0.048018746078014374, 0.08425824996083975, -0.15592912631109357, 0.040053628385066986, 0.008950496092438698, 0.03001912380568683, 0.17688062426168472, 0.03273987350985408, -0.08265837409999222, 0.08471162710338831, 0.0606200008187443, -0.23255900014191866, 0.18785487301647663, 0.13321887329220772, -0.01990237459540367, -0.2335475031286478, 0.30895349429920316, -0.05371775047387928, -0.007231496274471283, 0.11476978166319896, -0.02210099925287068, -0.09020875208079815, 0.07867168779785061, 0.12072350131347775, -0.15708862151950598, 0.04721024911850691, 0.20751625392585993, 0.10630662320181727, -0.08781037450535223, -0.0319317476823926, -0.007547498680651188, -0.05206425650976598, -0.033504755003377795, 0.14465765554632526, 0.05242087598890066, -0.14087124913930893, 0.02055194506283442, -0.11551124695688486, 0.03085974685382098, -0.05744237266480923, 0.07168371498119086, 0.3893325012177229, -0.14926475763786584, 0.2654908783733845, -0.11388912703841925, -0.06506892171455547, 0.07950949692167342, 0.029933753423392773, 0.062094118911772966, -0.13001562375575304, -0.14579625218175352, 0.02584387268871069, -0.04589076555566862, 0.022567501640878618, -0.2531725000590086, 0.13758100010454655, -0.02504875068552792, -0.05182137759402394, -0.09303041454404593, -0.10480825370177627, -1.1436837315559387, -0.061521127820014954, -0.18729982574586757, -0.168421502225101, 0.10245050070807338, 0.020661378279328346, 0.048587812460027635, -0.04446575278416276, -0.02504924894310534, -0.0007035024464130402, -0.021189624443650246, 0.1627291365293786, -0.041405995609238744, -0.13125625159591436, -0.12830290803685784, -0.15598900150507689, 0.10962124355137348, 0.1273749964311719, 0.16331001184880733, -0.03325687861070037, 0.10149877474759705, 0.07187601597979665, 0.26074149552732706, -0.008485921600367874, 0.14085299661383033, 0.007417064654873684, 0.08691374771296978, 0.0075507506262511015, -0.28701575193554163, -0.05360000021755695, -0.09182225167751312, 0.008912525954656303, 0.06647912133485079, 0.03809624724090099, -0.10928537603467703, -0.8784200130030513, -0.06426562089473009, 0.2537323397700675, -0.0019163740798830986, 0.2507597506046295, -0.12628156278515235, 0.018693752586841583, 0.16781875304877758, -0.02428249455988407, 0.11871900269761682, -0.04109762352891266, -0.35854900046251714, -0.043446063122246414, 0.10630424716509879, 0.15200375579297543, 0.1397878474817844, -0.048354121623560786, 0.0016499962657690048, -0.05030450411140919, 0.20706750079989433, 0.06545076554175466, 0.10243125259876251, -0.02782875206321478, 0.18280911562032998, -0.00457125436514616, -0.13455650093965232, 0.15067162923514843, -0.16459862422198057, -0.04593537817709148, 0.03894137730821967, 0.19413474993780255, 0.20388788983109407, -0.005041248165071011, 0.11135081664542668, -0.11466767371166497, -0.061150250025093555, -0.00378625001758337, 0.19377337873447686, 0.1187897501513362, 0.19363599992357194, 0.30056658561807126, -0.03398280014516786, -0.013939124532043934, -0.109500243794173, 0.25109712313860655, 0.2489515487686731, 0.07964274869300425, 0.005500000901520252, -0.1472500003874302, 0.12111624702811241, 0.03575100004673004, -0.014584249816834927, 0.08804287668317556, -0.05219600338023156, 0.0932407530490309, 0.24973624851554632, -0.1523068738169968, 0.08570299809798598, 0.051156748086214066, -0.0683136295992881, 0.11373612377792597, 0.028854988515377045, 0.151979751419276, -0.12947562558110803, 0.13091587414965034, 0.04064739772002213, -0.25869887974113226, -0.15305862319655716, -0.024001812271308154, -0.0674311276525259, 0.006737001007422805, 0.25359099730849266, -0.023315750993788242, 0.1531761228106916, 0.1150016791652888, 0.31915674824267626, 0.03721600002609193, 0.15345052600605413, -0.14419312588870525, 0.2501436247257516, -0.13952249940484762, 0.015869993716478348, -0.24746537674218416, 0.010288752615451813, -0.014982254360802472, 0.011384249199181795, 0.0321026211604476, -0.13308081761533685, -0.18864237051457167, 0.07601599767804146, 0.2369562489911914, 0.20057599805295467, 0.0019681269768625498, -0.008618685067631304, -0.18593749590218067, -0.058217499405145645, 0.0743661264423281, 0.09098125249147415, -0.09569446538807824, 0.14639499876648188, -0.01849299855530262, -0.3060860042460263, -0.09122999384999275, 0.034652450354769826, 0.08365887682884932, -0.167927875649184, -0.14938963088206947, 0.035461499355733395, -0.13165687047876418, -0.10726250428706408, 0.1951316255144775, 0.12228563102326007, -0.12901132239494473, -0.20743462722748518, -0.1636890013469383, 0.14413250144571066, -0.132219263818115, -0.12222274514715536, -0.21101587545126677, -0.14396937284618616, -0.11238837242126465, 0.056477499194443226, -0.03429787512868643, 0.27706062514334917, 0.14104999601840973, -0.26116524916142225, -0.009548999019898474, -0.06955550005659461, 0.05420375429093838, 0.2655237438157201, 0.2463145002257079, -0.010558197041973472, -0.1868944955058396, 0.1776344598038122, 0.037545374827459455, 0.23025675141252577, 0.3536931665148586, 0.014183149651216809, -0.02583762537688017, -0.0033950055949389935, -0.11621981466305442, -0.22858437336981297, -0.18835650105029345, 0.27277799788862467, 0.10505437897518277, -0.0840878770686686, -0.15461112326011062, -0.020061248913407326, 0.05921625252813101, 0.21453024819493294, 0.08027850277721882, 0.1243876937078312, -0.005361751653254032, -0.09887275146320462, 0.20926262764260173, 0.15439787530340254, 0.20413861935958266, 0.028542877174913883, -0.08454512525349855, -0.038231498561799526],                      [-0.1082395591462652, 0.11148611373371548, -0.059069646005001336, -0.260129999783304, -0.21701706873459947, 0.026794999837875366, 0.024089555359548993, 0.2784141862195813, 0.21637777653005388, 1.1724789043267567, -0.07725221912066142, 0.05796934312416448, 0.06581311134828462, 0.016416891581482358, -0.030264002167516284, 0.13321800188471875, -0.1223871140844292, 1.378979977634218, -0.0366367751525508, -0.12097144188980262, 0.09874988926781549, -0.08395644463598728, 0.07218155264854431, 0.061116769909858704, 0.22780111183722815, 0.10731222480535507, 0.2864866654078166, 0.0437722181280454, 0.11866168020707038, -0.12738257967349556, -0.20338711059755749, 0.14832147490233183, 0.17835757951252162, -0.14787322365575367, 0.07827888760301802, 0.08348122197720739, 0.002550110634830263, 0.15885555413034227, -0.0869519565668371, -0.017784443994363148, -0.03508455492556095, -0.05355544595254792, -0.14912322618895107, 0.20260888834794363, -0.12662522080871794, -0.08730032926218377, -0.19956066438721287, 0.07691110836135016, -0.18084065947267744, 0.13967888616025448, 0.14107086561206314, 0.14235777490668827, -0.08915488753053877, 0.25592999822563595, -0.33838944219880635, 0.02699933387339115, -0.06827788822637457, 0.07559988833963871, 0.0438397770954503, 0.29414910988675225, 0.09740133500761455, 0.22454444360401896, 0.015087891952134669, -0.1254066311650806, 0.25644244046674836, 0.11766033661034372, -0.06092244510849317, -0.0515256668958399, 0.07941507739532325, -0.07252622685498661, -0.06525377753294176, 0.009128998965024948, 0.14747088650862375, -0.20739022228452894, 0.12409055357178052, 0.09170877674801482, -0.05244401046851029, -0.18669499788019392, -0.03086600245700942, 0.37042222089237636, -0.31913166493177414, -0.004783111313978831, 0.1350244465801451, -0.18231644357244173, 0.1266674219837619, -0.11404332849714491, -0.3304539187552614, 0.01894244800011317, 0.0014009105765985118, 0.004208221203751034, -0.24440866460402808, 0.04034510078943438, -0.20059477744830978, 0.022727665180961292, 0.18897967144019073, -0.11393455664316814, -0.05634455465608173, 0.13122988947563702, 0.05027000274923113, 0.05303711216482851, 0.05436811389194594, -0.09588489205473, -0.10136445512762293, 0.10815277612871593, 0.1898219053594706, -0.8415466563569175, 0.08876744223137696, 0.016675000803338155, 0.019930218242936663, 0.060733329918649465, 0.19498921972182062, -0.13086721901264456, 0.001876420056861308, -0.221774665845765, -0.1685403316385216, 0.1555295574168364, -0.0837563317683008, 0.13930233216120136, -0.12712222503291237, -0.03092011022898886, 0.06054688700371318, -0.03511222783062193, -0.17295992105371422, 0.1005731142229504, -0.019825776831971273, 0.17335166409611702, 0.131676670577791, 0.3168753327594863, 0.11416522082355288, -0.1517015542421076, 0.29021338544165093, 0.2063630057705773, -0.06367422226402494, -0.04931688805421194, -0.06357411129607095, 0.09853311255574226, 0.07019044541650349, -0.07844866729444927, 0.10593522505627738, -0.02462277602818277, -0.27140600979328156, 0.03801679598271019, -0.06570688510934512, -0.013624443724337552, -0.072608331632283, -0.1305277794599533, -0.10879595588064855, -0.1776544435156716, 0.04107988625764847, 0.04383755806419584, 0.16906910720798704, -0.19997422107391888, -0.19104578123531407, 0.22432666934198803, -0.10377266961667272, -0.02267966854075591, 0.08873166764775912, -0.13885555581914055, -0.008077375564931167, -0.07489037901783983, 0.1355931187669436, -0.098623668981923, -0.038696867362078696, -0.07255455375545555, -0.1649076126050204, -0.23849888973765904, 0.16166010747353235, -0.13454333113299477, 0.03891344409849909, 0.19248788948688242, -0.046345212147571146, 0.1549090039398935, 0.13253311357564396, -0.41733192357545096, 0.12565966405802304, -0.07758944440219137, 0.08050421480503347, 0.004871116744147407, 0.1486771082919505, 0.014228477841243148, 0.20929667043189207, 0.10921689019434982, 0.1268011113214824, 0.05195744459827741, -0.17403777771525913, -0.040495552950435214, -0.12024755196438895, -0.07163445304872261, 0.02975822240114212, 0.02914366602069802, -0.24036476678318447, -0.05059900155497922, -0.10786199486917919, 0.056194997703035675, -0.115654110080666, -4.744198587205675e-05, -0.003075776207778189, 0.10078069016647835, -0.1751921127239863, 0.3737733330991533, -0.07173408759343955, -0.16653910962243876, 0.20095811349650225, 0.105957782930798, -0.1744924456708961, -0.22776222394572365, -0.14231513692195424, -0.015387558274798922, -0.05886834271303895, 0.04595211189654139, -0.1925529221383234, -0.12993711233139038, 0.026026226580142975, -0.3159888858596484, 0.05533378157350752, -0.16919555432266659, -0.10206055247949229, 0.11404277570545673, -0.41838888658417595, 0.004752334414256943, 0.17055422067642212, 0.353164441883564, -0.12440233243008454, -0.03769677794641919, 0.04095389031701618, -0.0378140045536889, 0.0750261139538553, 0.20125254967974293, 0.07967277988791466, 0.19282666247131097, -0.04899111183153258, -0.0034674484696653155, -0.007359222405486637, -0.13216810839043724, -0.1467799958255556, 0.22206844555007088, -0.12397300038072798, -0.021942670560545392, -0.15065333247184753, 0.1386275572909249, 0.1381751091943847, -0.029867553876505956, -0.1197377774450514, 0.005468331484331025, -0.07888536641581191, -0.33898355811834335, -0.07440999812550014, -0.00968922208994627, -0.05376610822147793, 0.2110650421301317, 0.0752595111520754, 0.17887422525220448, -0.19797522160742018, -0.052063557526303664, -0.006764222350385454, -0.29218223028712803, -0.11202655939592256, -0.03528899865017997, 0.07494055148628023, -0.12307077273726463, 0.1097454447299242, 0.07872899828685655, -0.09476077722178565, 0.16510166072597107, -0.06873733426133792, -0.24297366581029362, -0.06559944566753176, 0.002723890356719494, 0.6011466689200865, 0.027954888840516407, -0.25385899572736687, 0.12965955585241318, -0.04824345589925846, -0.2210159518549012, -0.32522344920370316, -0.07183777665098508, 0.1567944437265396, 0.09644377438558473, -0.17133377657996285, -0.066881005341808, 0.08840110898017883, -0.28226477921836907, 0.07300955678025882, -0.15032671332462794, -0.0987233320871989, -0.28752955773638356, -0.257315445277426, -0.14715421944856644, -0.015145891242557101, -0.10141125378302401, -0.2035666671064165, -0.05218385775677032, -0.17457670790867674, 0.3051390043563313, 0.004346671203772227, 0.05074722237057156, 0.05136778040064706, 0.0315119920608898, 0.12979599688616064, -0.05381566524091694],                      [-0.09469362325035036, -9.850366041064262e-05, 0.02765700244344771, 0.017622121958993375, -0.15849037398584187, -0.08674885029904544, -0.060386248398572206, -0.08924099756404757, -0.04248024709522724, 1.5197187587618828, -0.2983733572255005, -0.11917975172400475, 0.031371627701446414, 0.01598712708801031, -0.06999062770046294, 0.08200637274421751, -0.1951763704419136, 0.44033725978806615, 0.09292749501764774, -0.0519848745316267, 0.049248500959947705, -0.07547987019643188, 0.06532037537544966, 0.004116248805075884, 0.0638772496022284, -0.043619997799396515, 0.005555001087486744, 0.07954999699722975, -0.017668874002993107, 0.22256063955137506, 0.006203663448104635, 0.22815541306044906, 0.06983752441010438, 0.1592486221343279, 0.12846249900758266, -0.0892163785174489, -0.027100750827230513, -0.03164707886753604, -0.12254673766437918, 0.0629784984048456, 0.029688252368941903, 0.06557000428438187, -0.01331037562340498, 0.03027424868196249, 0.10384749993681908, -0.07909012865275145, -0.02181750163435936, 0.06864874978782609, 0.01938699744641781, 0.06485587800852954, 0.029504625126719475, 0.1447847445961088, 0.0933517487719655, -0.027306251926347613, -0.14846162497997284, 0.09303450025618076, -0.02873818762600422, 0.02823612466454506, 0.10162662528455257, -0.12275702066835947, -0.058254490490071476, -0.046665753703564405, 0.11342349811457098, -0.03909499756991863, 0.14697137544862926, -0.10817112575750798, -0.07926900219172239, 0.013809119816869497, 0.05895550223067403, -0.12117462325841188, -0.062437500804662704, -0.018548751715570688, 0.010036121122539043, -0.02976624947041273, 0.26746787363663316, -0.2222843747586012, -0.15902212262153625, 0.026075002271682024, 0.008115374017506838, 0.32644287729635835, -0.0782088739797473, 0.15396849438548088, 0.05064700078219175, -0.1669064403977245, 0.03586337622255087, -0.013545623049139977, 0.04596451128600165, -0.2030745092779398, 0.06314587453380227, -0.03125487617217004, -0.006361749256029725, 0.17199652863200754, -0.07240524957887828, 0.04870750266127288, 0.21136712469160557, -0.036062372382730246, 0.03253375133499503, 0.10400099912658334, 0.002972501330077648, -0.02521337545476854, -0.11940000019967556, -0.1359496267978102, 0.22647562762722373, -0.13154962938278913, -0.026466358212928753, -0.6520712450146675, 0.013404622091911733, 0.12211874686181545, 0.04785962461028248, 0.13350212946534157, 0.06014474807307124, 0.02188637387007475, -0.05634396831737831, -0.05062874872237444, -0.25480837514624, 0.2269426309503615, 0.055165335768833756, 0.012400873936712742, -0.32095949724316597, -0.1448808794375509, -0.13577412441372871, -0.028492129873484373, -0.02968699624761939, 0.1119413036503829, -0.0007352510001510382, 0.07932987762615085, 0.07073462475091219, -0.034278872539289296, -0.1355370900419075, 0.07608062378130853, -0.05079224845394492, -0.001117252279073, 0.033574750646948814, 0.056018378119915724, -0.04066825145855546, -0.015443750657141209, -0.117769134871196, 0.06823100103065372, -0.05881350045092404, -0.10378000279888511, -1.1250165002420545, -0.016353254206478596, 0.17944224970415235, -0.09441537270322442, 0.07496299874037504, 0.1006203789729625, 0.013139948845491745, 0.17886300664395094, -0.00016849953681230545, 0.11986787291243672, 0.033997124992311, -0.010692501324228942, -0.09721749927848577, 0.08853713050484657, 0.2088652439415455, 0.1755359978415072, 0.08682199846953154, -0.0071868738159537315, -0.07378926055389456, 0.13623049391196673, 0.029008126351982355, -0.05806787544861436, 0.09047337435185909, 0.24027837673202157, 0.05085349781438708, -0.32329012732952833, 0.16417349828407168, -0.20585112739354372, 0.04181525018066168, 0.09293637797236443, 0.045091125182807446, 0.13247675215825438, 0.21328636957332492, -0.1435407530516386, 0.02415960624057334, 0.1682471873355098, 0.03314130930812098, 0.07190450048074126, 0.057932774128858, 0.02364250272512436, 0.059134999522939324, 0.012326999567449093, 0.07297737745102495, -0.18717438052408397, 0.018804503604769707, -0.03879587538540363, 0.01358374860137701, -0.07160487351939082, -0.014068749034777284, -0.02813787618651986, -0.13538012374192476, -0.12144900346174836, 0.004355624318122864, 0.049980124458670616, 0.06963665201328695, 0.01267874613404274, 0.06930825486779213, 0.005255876574665308, 0.12106287339702249, 0.15374275064095855, 0.0515833729878068, 0.10882712132297456, -0.0041866241954267025, -0.05592599930241704, 0.110875747166574, 0.0007557515054941177, 0.002284999005496502, 0.04852737579494715, 0.09150487883016467, -0.003443252295255661, 0.10873846005415544, -0.1473150011152029, 0.05161375179886818, 0.0195523789152503, -0.03329000063240528, -0.10074437619186938, -0.06925426859379513, 0.19222649279981852, -0.18971825297921896, 0.007284627528861165, 0.07985728944186121, 0.23027812596410513, 0.06345025124028325, 0.03239787649363279, 0.007137622684240341, -0.04811974801123142, 0.17461186926811934, 0.2378942440263927, 0.21574036963284016, 0.08530462300404906, 0.10176124982535839, 0.14158162497915328, -0.164142788737081, -0.13882574997842312, -0.00882037915289402, -0.018666375195607543, -0.035316373279783875, -0.0026971892220899463, 0.05271199718117714, 0.1363550005480647, 0.10376650193938985, -0.06970499688759446, 0.17668587854132056, -0.16593124764040112, 0.31350862327963114, -0.06234012870118022, 0.07242900924757123, 0.05885012727230787, -0.018257376737892628, 0.01775987818837166, 0.05816862662322819, 0.08146974723786116, -0.06061774771660566, -0.13455550093203783, -0.10433149477466941, 0.10757480002939701, 0.17263424559496343, -0.16967337438836694, -0.05027787573635578, 0.03577425004914403, -0.009145624935626984, 0.05703649949282408, 0.05096662184223533, 0.12711837084498256, 0.026997250504791737, -0.25567356843384914, 0.0373159994778689, 0.12072325160261244, 0.2048256192356348, 0.07422237144783139, -0.1077963737770915, -0.007575874449685216, -0.08510726888198406, 0.05983375385403633, 0.016272499226033688, 0.135579873342067, 0.19346299627795815, 0.0745241241529584, 0.07152700296137482, 0.09217737335711718, 0.01872224872931838, -0.09116400149650872, 0.16662625782191753, 0.12297069907072, -0.02554412349127233, 0.05493425112217665, 0.1195411211811006, 0.007948127342388034, 0.030111413507256657, -0.06002962635830045, -0.15772585140075535, 0.10969537682831287, -0.1251249983906746, -0.04739912447985262, 0.1277742520906031, 0.24739111738745123, 0.07914299797266722, -0.05949536804109812, -0.18356150039471686, 0.12938537157606333]],                      columns=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299],                      index=['recommender', 'warren', 'biden', 'machinelearning', 'brexit'])

    pd.testing.assert_frame_equal(utility.astype("float64"), solution)
    print("Success")

    print("Testing similarity: ", end="")
    solution = DataFrame([[1.0000000000000004, 0.1482048343392846,
                           0.2795813063078053, 0.7071925328668537,
                           0.37988977742403685],
                          [0.1482048343392846, 0.9999999999999997,
                           0.6511502105581992, 0.18492897550913753,
                           0.4700805613893001],
                          [0.2795813063078053, 0.6511502105581992,
                           1.0000000000000002, 0.3791593177658622,
                           0.6414505000391922],
                          [0.7071925328668537, 0.18492897550913753,
                           0.3791593177658622, 1.0, 0.49389592720300945],
                          [0.37988977742403685, 0.4700805613893001,
                           0.6414505000391922, 0.49389592720300945,
                           0.9999999999999996]],
                         columns=['recommender', 'warren', 'biden',
                                  'machinelearning', 'brexit'],
                         index=['recommender', 'warren', 'biden',
                                'machinelearning', 'brexit'])

    pd.testing.assert_frame_equal(similarity.astype("float64"), solution)
    print("Success")